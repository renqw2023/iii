# 提示词上传限制调整修改

## 修改日期
2025-01-25

## 修改内容
根据用户需求，将提示词创建页面的示例图片上传限制进行调整：
- 上传文件数量：从3张调整为9张
- 单个文件大小：从10MB调整为20MB

## 修改文件

### 前端修改

#### 1. CreatePrompt.js 组件
- **文件**: `client/src/pages/CreatePrompt.js`
- **修改内容**:
  - useDropzone配置：maxFiles 从 3 改为 9
  - useDropzone配置：maxSize 从 10MB 改为 20MB

#### 2. 国际化文件
- **文件**: `client/src/i18n/modules/createPrompt.js`
- **修改内容**:
  - 中文描述："最多3个文件" → "最多9个文件"
  - 中文文件大小："最大 10MB" → "最大 20MB"
  - 英文描述："max 3 files" → "max 9 files"
  - 英文文件大小："max 10MB" → "max 20MB"
  - 日文描述："最大3ファイル" → "最大9ファイル"
  - 日文文件大小："最大10MB" → "最大20MB"
  - 错误提示信息：所有语言的文件大小限制错误提示都已更新

#### 3. 帮助页面
- **文件**: `client/src/i18n/modules/help.js`
- **修改内容**:
  - 中文："单个文件大小不超过 10MB，每次最多上传 4 个文件" → "单个文件大小不超过 20MB，每次最多上传 9 个文件"
  - 英文："Single file size should not exceed 10MB, up to 4 files" → "Single file size should not exceed 20MB, up to 9 files"
  - 日文："単一ファイルサイズは10MBを超えず、一度に最大4ファイル" → "単一ファイルサイズは20MBを超えず、一度に最大9ファイル"

### 后端修改

#### 1. 提示词路由
- **文件**: `server/routes/prompts.js`
- **修改内容**:
  - multer配置：fileSize 从 10MB 改为 20MB
  - multer配置：files 从 3 改为 9
  - 注释更新："最多3个示例图片" → "最多9个示例图片"

#### 2. 上传路由错误提示
- **文件**: `server/routes/upload.js`
- **修改内容**:
  - 错误提示信息："文件大小超过限制(10MB)" → "文件大小超过限制(20MB)"

## 技术实现

### 前端实现
1. **文件上传组件**:
   - 使用 react-dropzone 库处理文件拖拽上传
   - maxFiles 参数控制最大文件数量
   - maxSize 参数控制单个文件大小限制
   - 实时文件验证和错误提示

2. **国际化支持**:
   - 支持中文、英文、日文三种语言
   - 统一的错误提示信息
   - 用户界面文本的完整本地化

### 后端实现
1. **文件上传处理**:
   - 使用 multer 中间件处理文件上传
   - limits 配置控制文件大小和数量限制
   - 文件类型验证和错误处理
   - 自动创建用户专属目录结构

2. **错误处理**:
   - 统一的错误响应格式
   - 详细的错误信息提示
   - 多语言错误消息支持

## 影响范围
- 提示词创建页面的文件上传体验
- 用户可以上传更多示例图片展示效果
- 支持更大的文件尺寸，提升图片质量
- 帮助页面的相关说明更新

## 测试建议
1. **功能测试**:
   - 测试上传1-9个文件的正常流程
   - 测试上传超过9个文件时的限制提示
   - 测试上传超过20MB文件时的错误提示
   - 测试不同文件格式的上传支持

2. **界面测试**:
   - 验证中文、英文、日文界面的文本显示
   - 确认错误提示信息的准确性
   - 检查帮助页面的说明更新

3. **兼容性测试**:
   - 测试不同浏览器的文件上传功能
   - 验证移动端的上传体验
   - 确认服务器端的文件处理正常

## 注意事项
- 前后端限制保持一致，避免验证冲突
- 用户界面提供清晰的限制说明
- 错误提示信息友好且具体
- 修改不影响现有提示词数据
- 服务器存储空间需要相应调整

## 后续优化建议
1. 考虑添加文件压缩功能，优化存储空间
2. 实现图片预览和编辑功能
3. 添加批量上传进度显示
4. 考虑支持更多文件格式（如WebP）
5. 实现文件去重功能，避免重复上传