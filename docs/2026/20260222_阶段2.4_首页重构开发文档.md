# 阶段 2.4 — 首页重构开发文档

> **日期**: 2026-02-22  
> **开发范围**: 首页内容展示区域重构，采用 meigen.ai 暗色 UI 风格

---

## 一、背景与目标

根据 [项目重构详细执行计划](./20260222_项目重构详细执行计划.md) **阶段 2.4** 的要求，将首页内容展示部分从原先的**白色背景 Tailwind 浅色风格**重构为与 Gallery / Seedance 页面一致的 **meigen.ai 暗色主题 UI 风格**。

### 重构前现状
- `Home.js`：Hero + FeaturedPosts + 搜索/标签/排序 + 混合内容网格（白色背景）
- Gallery/Seedance 页面已实现完整暗色 UI（`gallery.css`，844 行）
- 首页风格与新板块视觉不统一

### 重构后效果
- 首页 Hero 下方全部采用暗色渐变背景
- 新增三大板块快速入口卡片（毛玻璃暗色风格）
- 新增 Gallery 精选 / Seedance 精选推荐区块
- 搜索、标签过滤、排序控件全部使用 gallery 暗色样式
- 内容网格使用 gallery-grid 布局

---

## 二、修改文件清单

| 操作 | 文件 | 说明 |
|------|------|------|
| **MODIFY** | `client/src/pages/Home.js` | 完全重写首页组件，集成 Gallery/Seedance 精选 |
| **MODIFY** | `client/src/styles/gallery.css` | 追加 ~275 行首页专用暗色 CSS |

---

## 三、Home.js 重构详情

### 3.1 新的页面结构

```
<Hero />                                ← 保持不变
<div class="home-dark-area">            ← 新增暗色渐变容器
  ├─ Explore Our Collections           ← 三大板块入口
  │   ├─ MJ 风格参数 → /explore
  │   ├─ AI 提示词库 → /gallery
  │   └─ Seedance 视频 → /seedance
  ├─ Featured AI Prompts               ← Gallery 精选推荐（条件渲染）
  ├─ Seedance 2.0 精选视频              ← Seedance 精选推荐（条件渲染）
  └─ Latest Content                    ← 搜索 + 排序 + 标签 + 内容网格
      ├─ Search Bar (gallery-search-box 风格)
      ├─ Tag Filter (tag-filter-btn 风格)
      ├─ Sort Select (gallery-sort-select 风格)
      └─ Content Grid (gallery-grid 布局 + 无限滚动)
</div>
```

### 3.2 新增依赖导入

```javascript
// 新增 API 服务
import { galleryAPI } from '../services/galleryApi';
import { seedanceAPI } from '../services/seedanceApi';

// 新增组件
import GalleryCard from '../components/Gallery/GalleryCard';
import VideoCard from '../components/Seedance/VideoCard';
```

### 3.3 删除的依赖

- `FeaturedPosts` 组件（替换为 Gallery/Seedance 精选）
- `Filter` 图标（替换为 `SlidersHorizontal`）

### 3.4 新增数据查询

| Query Key | API 调用 | 用途 |
|-----------|---------|------|
| `homeFeaturedGallery` | `galleryAPI.getFeatured(8)` | 获取 Gallery 精选提示词 |
| `homeFeaturedSeedance` | `seedanceAPI.getFeatured(6)` | 获取 Seedance 精选视频 |

### 3.5 保留的功能

- 搜索防抖（300ms debounce）
- 无限滚动加载
- 热门标签合并去重
- Ctrl+K 快捷键搜索
- 混合内容排序（风格帖 + 提示词按时间排序）

---

## 四、gallery.css 追加样式

追加了以下 CSS 类组（约 275 行）：

| 类名 | 用途 |
|------|------|
| `.home-dark-area` | 暗色渐变背景容器 |
| `.home-section` | 各区块通用容器 |
| `.home-section-header` | 区块标题（gradient-text + 白色混合） |
| `.home-section-link` | "查看全部 →" 链接 |
| `.home-entry-grid` | 三列入口卡片网格 |
| `.home-entry-card` | 入口卡片（暗色毛玻璃 + hover 渐变） |
| `.home-entry-icon` | 入口卡片图标容器 |
| `.home-error-state` | 错误状态页面 |
| `.home-load-more` | 加载更多提示 |

### 响应式断点

- **768px 以下**：入口卡片从三列变为单列横排布局；区块标题缩小
- **480px 以下**：减少内边距

---

## 五、测试验证

### 5.1 编译检查
- ✅ `react-scripts` 编译通过，无错误
- ✅ 无 ESLint 错误（修复了 unused `TrendingUp` import）

### 5.2 视觉验证（浏览器截图确认）
- ✅ Hero 区域正常渲染（ImageFlow 背景动画可见）
- ✅ "Explore Our Collections" 三张入口卡片在暗色背景上显示正确
- ✅ 搜索框使用 gallery-search-box 暗色风格
- ✅ 标签过滤使用 tag-filter-btn 暗色风格
- ✅ 排序下拉使用 gallery-sort-select 暗色风格
- ✅ 空状态使用 gallery-empty 暗色风格（含 CTA 按钮）
- ✅ 页脚渲染正常

### 5.3 功能回归
- ✅ 导航至 `/gallery` 页面正常
- ✅ 导航至 `/seedance` 页面正常
- ✅ Ctrl+K 快捷键可触发搜索框聚焦

---

## 六、注意事项

1. **Gallery/Seedance 精选区块为条件渲染**：仅在 API 返回数据时展示。若数据库中尚未导入数据，这两个区块不会显示，不影响页面布局。
2. **旧版 `FeaturedPosts` 组件未删除文件**：仅在 `Home.js` 中移除了引用，组件文件本身保留，不影响其他可能的使用。
3. **CSS 变量兼容**：所有暗色样式使用 `var(--xxx, fallback)` 模式，确保在无 CSS 变量支持时有合理的降级值。
