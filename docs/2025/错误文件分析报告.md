# é”™è¯¯æ–‡ä»¶ä¸Šä¼ åˆ†ææŠ¥å‘Š

## ğŸš¨ é—®é¢˜æ¦‚è¿°

åœ¨ä¹‹å‰çš„è„šæœ¬æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç”±äºæ‰¹å¤„ç†è„šæœ¬çš„è·¯å¾„å¤„ç†é—®é¢˜ï¼Œå¯¼è‡´å¤šä¸ªæ–‡ä»¶è¢«ä¸Šä¼ åˆ°äº†é”™è¯¯çš„ä½ç½®ã€‚è¿™äº›é”™è¯¯æ–‡ä»¶å¯èƒ½ä¼šå¯¼è‡´ï¼š

- æœåŠ¡å¯åŠ¨å¤±è´¥
- æ¨¡å—å¯¼å…¥é”™è¯¯
- æ„å»ºå¤±è´¥
- åŠŸèƒ½å¼‚å¸¸

## ğŸ“‹ å‘ç°çš„é”™è¯¯æ–‡ä»¶åˆ—è¡¨

### åç«¯é”™è¯¯æ–‡ä»¶

| é”™è¯¯ä½ç½® | æ­£ç¡®ä½ç½® | æ–‡ä»¶è¯´æ˜ |
|---------|---------|----------|
| `/var/www/mj-gallery/server/admin.js` | `/var/www/mj-gallery/server/routes/admin.js` | ç®¡ç†å‘˜è·¯ç”±æ–‡ä»¶ |
| `/var/www/mj-gallery/server/PromptPost.js` | `/var/www/mj-gallery/server/models/PromptPost.js` | æç¤ºè¯æ•°æ®æ¨¡å‹ |
| `/var/www/mj-gallery/server/prompts.js` | `/var/www/mj-gallery/server/routes/prompts.js` | æç¤ºè¯è·¯ç”±æ–‡ä»¶ |

### å‰ç«¯é”™è¯¯æ–‡ä»¶

| é”™è¯¯ä½ç½® | æ­£ç¡®ä½ç½® | æ–‡ä»¶è¯´æ˜ |
|---------|---------|----------|
| `/var/www/mj-gallery/client/src/CreatePrompt.js` | `/var/www/mj-gallery/client/src/pages/CreatePrompt.js` | åˆ›å»ºæç¤ºè¯é¡µé¢ |
| `/var/www/mj-gallery/client/src/PromptCard.js` | `/var/www/mj-gallery/client/src/components/PromptCard.js` | æç¤ºè¯å¡ç‰‡ç»„ä»¶ |
| `/var/www/mj-gallery/client/src/PromptDetail.js` | `/var/www/mj-gallery/client/src/pages/PromptDetail.js` | æç¤ºè¯è¯¦æƒ…é¡µé¢ |
| `/var/www/mj-gallery/client/src/PromptList.js` | `/var/www/mj-gallery/client/src/pages/PromptList.js` | æç¤ºè¯åˆ—è¡¨é¡µé¢ |
| `/var/www/mj-gallery/client/src/promptApi.js` | `/var/www/mj-gallery/client/src/services/promptApi.js` | æç¤ºè¯APIæœåŠ¡ |

## ğŸ” é—®é¢˜åŸå› åˆ†æ

1. **æ‰¹å¤„ç†è„šæœ¬è·¯å¾„å¤„ç†é”™è¯¯**ï¼šSCPå‘½ä»¤ä¸­çš„ç›®æ ‡è·¯å¾„æ²¡æœ‰æ­£ç¡®æŒ‡å®šå­ç›®å½•
2. **æ–‡ä»¶ç»“æ„ç†è§£åå·®**ï¼šè„šæœ¬ç¼–å†™æ—¶å¯¹é¡¹ç›®ç»“æ„çš„ç†è§£ä¸å¤Ÿå‡†ç¡®
3. **ç¼ºä¹éªŒè¯æœºåˆ¶**ï¼šä¸Šä¼ åæ²¡æœ‰åŠæ—¶éªŒè¯æ–‡ä»¶ä½ç½®çš„æ­£ç¡®æ€§

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨è‡ªåŠ¨æ¸…ç†è„šæœ¬ï¼ˆæ¨èï¼‰

è¿è¡Œ `cleanup-wrong-uploads.bat` è„šæœ¬ï¼š

```bash
# åœ¨ d:\fenge ç›®å½•ä¸‹è¿è¡Œ
cleanup-wrong-uploads.bat
```

**è„šæœ¬åŠŸèƒ½ï¼š**
- âœ… è‡ªåŠ¨åˆ›å»ºæœåŠ¡å™¨å¤‡ä»½
- âœ… æ£€æµ‹æ‰€æœ‰é”™è¯¯ä½ç½®çš„æ–‡ä»¶
- âœ… å®‰å…¨åˆ é™¤é”™è¯¯æ–‡ä»¶
- âœ… éªŒè¯æ­£ç¡®ä½ç½®çš„æ–‡ä»¶å­˜åœ¨
- âœ… é‡å¯æœåŠ¡ç¡®ä¿ç”Ÿæ•ˆ

### æ–¹æ¡ˆäºŒï¼šæ‰‹åŠ¨æ¸…ç†ï¼ˆå¤‡é€‰ï¼‰

å¦‚æœè‡ªåŠ¨è„šæœ¬å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# è¿æ¥æœåŠ¡å™¨
ssh root@167.253.157.83

# åˆ›å»ºå¤‡ä»½
cd /var/www/mj-gallery
tar -czf manual-cleanup-backup-$(date +%Y%m%d-%H%M%S).tar.gz server/ client/src/

# åˆ é™¤é”™è¯¯ä½ç½®çš„åç«¯æ–‡ä»¶
cd /var/www/mj-gallery/server
rm -f admin.js PromptPost.js prompts.js

# åˆ é™¤é”™è¯¯ä½ç½®çš„å‰ç«¯æ–‡ä»¶
cd /var/www/mj-gallery/client/src
rm -f CreatePrompt.js PromptCard.js PromptDetail.js PromptList.js promptApi.js

# é‡å¯æœåŠ¡
cd /var/www/mj-gallery
pm2 restart mj-gallery-server
cd client && npm run build
```

## ğŸ›¡ï¸ é¢„é˜²æªæ–½

1. **ä½¿ç”¨æ”¹è¿›çš„ä¸Šä¼ è„šæœ¬**ï¼š
   - `upload-prompt-simple.bat`ï¼ˆç¨³å®šç‰ˆæœ¬ï¼‰
   - `upload-prompt-stable.bat`ï¼ˆæ‰¹é‡ç‰ˆæœ¬ï¼‰

2. **é…ç½®SSHå¯†é’¥**ï¼š
   - æŒ‰ç…§ `ssh-setup-guide.md` é…ç½®å…å¯†ç™»å½•
   - é¿å…é¢‘ç¹è¾“å…¥å¯†ç å¯¼è‡´çš„æ“ä½œé”™è¯¯

3. **éªŒè¯æœºåˆ¶**ï¼š
   - æ¯æ¬¡ä¸Šä¼ åéªŒè¯æ–‡ä»¶ä½ç½®
   - æ£€æŸ¥æœåŠ¡çŠ¶æ€å’Œæ„å»ºç»“æœ

## ğŸ“Š å½±å“è¯„ä¼°

### å½“å‰çŠ¶æ€
- âŒ é”™è¯¯æ–‡ä»¶å¯èƒ½å¯¼è‡´æ¨¡å—å¯¼å…¥å¤±è´¥
- âŒ å‰ç«¯æ„å»ºå¯èƒ½å‡ºç°"Module not found"é”™è¯¯
- âŒ åç«¯æœåŠ¡å¯èƒ½æ— æ³•æ­£ç¡®åŠ è½½è·¯ç”±å’Œæ¨¡å‹

### æ¸…ç†åçŠ¶æ€
- âœ… æ‰€æœ‰æ–‡ä»¶ä½äºæ­£ç¡®ç›®å½•
- âœ… æ¨¡å—å¯¼å…¥è·¯å¾„æ­£ç¡®
- âœ… å‰ç«¯æ„å»ºæˆåŠŸ
- âœ… åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**ï¼šè¿è¡Œ `cleanup-wrong-uploads.bat` æ¸…ç†é”™è¯¯æ–‡ä»¶
2. **éªŒè¯ç»“æœ**ï¼šæ£€æŸ¥æœåŠ¡çŠ¶æ€å’ŒåŠŸèƒ½æ˜¯å¦æ­£å¸¸
3. **é…ç½®SSHå¯†é’¥**ï¼šé¿å…æœªæ¥çš„å¯†ç é—®é¢˜
4. **ä½¿ç”¨æ”¹è¿›è„šæœ¬**ï¼šåç»­ä¸Šä¼ ä½¿ç”¨ç¨³å®šç‰ˆæœ¬çš„è„šæœ¬

## ğŸ“ æ”¯æŒä¿¡æ¯

å¦‚æœæ¸…ç†è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æ£€æŸ¥å¤‡ä»½**ï¼šæ‰€æœ‰æ“ä½œå‰éƒ½ä¼šåˆ›å»ºå¤‡ä»½æ–‡ä»¶
2. **æŸ¥çœ‹æ—¥å¿—**ï¼š`ssh root@167.253.157.83 "pm2 logs mj-gallery-server"`
3. **æ¢å¤å¤‡ä»½**ï¼šå¦‚æœ‰éœ€è¦å¯ä»¥ä»å¤‡ä»½æ–‡ä»¶æ¢å¤

---

**åˆ›å»ºæ—¶é—´**ï¼š$(date)
**çŠ¶æ€**ï¼šå¾…å¤„ç†
**ä¼˜å…ˆçº§**ï¼šé«˜