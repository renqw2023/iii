# é˜¶æ®µ 0 & 1 å¼€å‘æ–‡æ¡£ â€” æ•°æ®å±‚æž„å»º

> ðŸ“… æ—¶é—´: 2026-02-22 20:36  
> ðŸ·ï¸ ç‰ˆæœ¬: Phase 0 + Phase 1  
> ðŸ“¦ ä»“åº“: https://github.com/renqw2023/iii

---

## ä¸€ã€é˜¶æ®µ 0 â€” å‡†å¤‡å·¥ä½œï¼ˆå·²å®Œæˆ âœ…ï¼‰

### 1.1 Git åˆå§‹åŒ–ä¸ŽæŽ¨é€
- åœ¨ `e:\pm01` ç›®å½•åˆå§‹åŒ– Git ä»“åº“
- åˆ›å»º `.gitignore` æ–‡ä»¶ï¼ˆæŽ’é™¤ node_modulesã€.envã€uploadsã€build ç­‰ï¼‰
- åˆå§‹æäº¤å¹¶æŽ¨é€åˆ° `https://github.com/renqw2023/iii`

### 1.2 æ•°æ®æºèŽ·å–
- æµ…å…‹éš† `awesome-seedance-2-prompts` åˆ° `_data_sources/seedance/`
- æµ…å…‹éš† `awesome-nano-banana-pro-prompts` åˆ° `_data_sources/nanobanana/`

**æ•°æ®æºåˆ†æžç»“æžœ:**

| æ•°æ®æº | è§„æ¨¡ | æ ¼å¼ |
|--------|------|------|
| NanoBanana Pro | 9716 æ¡æç¤ºè¯ | Markdown (README.md, 328KB) |
| Seedance 2.0 | 375 æ¡è§†é¢‘ URL | JSON (video-urls.json) + Markdown |

---

## äºŒã€é˜¶æ®µ 1 â€” æ•°æ®å±‚é‡æž„ï¼ˆå·²å®Œæˆ âœ…ï¼‰

### 2.1 æ–°å¢ž MongoDB æ•°æ®æ¨¡åž‹

#### `server/models/GalleryPrompt.js`
ç”»å»Šæç¤ºè¯æ¨¡åž‹ï¼Œç”¨äºŽå­˜å‚¨ä»Žå¤–éƒ¨æ•°æ®æºå¯¼å…¥çš„**å›¾åƒç”Ÿæˆ**æç¤ºè¯ã€‚

**æ ¸å¿ƒè®¾è®¡è¦ç‚¹:**
- **ä¸‰ç»´åˆ†ç±»ç³»ç»Ÿ**: `useCase`(ç”¨é€”) Ã— `style`(é£Žæ ¼) Ã— `subject`(ä¸»é¢˜)ï¼Œå¯¹é½ nano-banana-pro çš„ 41 ä¸ªå­ç±»
- **æ¨¡åž‹æ ‡è¯†**: æ”¯æŒ `nanobanana` / `midjourney` / `gptimage` / `other`
- **ç”¨æˆ·äº¤äº’**: `likes` å’Œ `favorites` æ•°ç»„æ”¯æŒç™»å½•ç”¨æˆ·çš„ç‚¹èµžä¸Žæ”¶è—
- **é“¾æŽ¥å¥åº·**: `linkHealth` å­—æ®µè·Ÿè¸ªå¤–éƒ¨é“¾æŽ¥çŠ¶æ€ï¼ˆlastChecked, isHealthy, failCountï¼‰
- **å…¨æ–‡æœç´¢**: å¯¹ `title`ã€`prompt`ã€`tags` å»ºç«‹ MongoDB text index
- **åŽ»é‡æœºåˆ¶**: `sourceId` å”¯ä¸€ç´¢å¼•ï¼Œé˜²æ­¢é‡å¤å¯¼å…¥

#### `server/models/SeedancePrompt.js`
Seedance 2.0 è§†é¢‘æç¤ºè¯æ¨¡åž‹ã€‚

**æ ¸å¿ƒè®¾è®¡è¦ç‚¹:**
- `videoUrl` æŒ‡å‘ GitHub Releases ä¸Šçš„ mp4 æ–‡ä»¶
- åˆ†ç±»æ¶µç›–ï¼šaction, anime, cinematic, dance, fight, sci-fi, fantasy ç­‰ 17 ç§
- åŒæ ·æ”¯æŒ `likes`ã€`favorites`ã€`linkHealth` å­—æ®µ

### 2.2 æ•°æ®å¯¼å…¥è„šæœ¬

#### `server/scripts/importNanoBanana.js`
ä»Ž `awesome-nano-banana-pro-prompts/README.md` è§£æžæç¤ºè¯æ•°æ®ã€‚

**å…³é”®æŠ€æœ¯:**
- ä½¿ç”¨æ­£åˆ™ `^#{2,4}\s*No\.\s*(\d+):\s*(.+?)` åŒ¹é…æ¯æ¡æç¤ºè¯çš„æ ‡é¢˜è¡Œ
- æå–æ ‡é¢˜åŽçš„ä»£ç å—æˆ–æ®µè½æ–‡æœ¬ä½œä¸ºæç¤ºè¯å†…å®¹
- ä½¿ç”¨å¯å‘å¼è§„åˆ™è‡ªåŠ¨åˆ†ç±»ï¼ˆ`extractUseCase`/`extractStyle`/`extractSubject`ï¼‰
- æ”¯æŒ `--dry-run` é¢„è§ˆæ¨¡å¼å’Œ `--limit` é™åˆ¶å¯¼å…¥æ•°é‡
- Upsert æ¨¡å¼é¿å…é‡å¤å¯¼å…¥

```bash
# é¢„è§ˆæ¨¡å¼
node server/scripts/importNanoBanana.js --dry-run

# é™åˆ¶å¯¼å…¥100æ¡æµ‹è¯•
node server/scripts/importNanoBanana.js --limit 100

# æ­£å¼å…¨é‡å¯¼å…¥
node server/scripts/importNanoBanana.js
```

#### `server/scripts/importSeedance.js`
ä»Ž `awesome-seedance-2-prompts` å¯¼å…¥è§†é¢‘æç¤ºè¯ã€‚

```bash
# é¢„è§ˆæ¨¡å¼
node server/scripts/importSeedance.js --dry-run

# æ­£å¼å¯¼å…¥
node server/scripts/importSeedance.js
```

**å¯¼å…¥æµç¨‹:**
1. è¯»å– `video-urls.json` èŽ·å– 375 ä¸ªè§†é¢‘ URL
2. è§£æž `README.md` èŽ·å–æ¯ä¸ªç¼–å·å¯¹åº”çš„æç¤ºè¯æ ‡é¢˜å’Œæè¿°
3. åˆå¹¶æ•°æ®ï¼Œauto-categorizeï¼ŒUpsert åˆ° MongoDB

### 2.3 API è·¯ç”±

#### `server/routes/gallery.js` â€” ç”»å»Š API

| ç«¯ç‚¹ | æ–¹æ³• | è®¤è¯ | è¯´æ˜Ž |
|------|------|------|------|
| `/api/gallery` | GET | å¯é€‰ | åˆ—è¡¨ï¼ˆæ”¯æŒ model/useCase/style/subject/tags/search/sort/page å‚æ•°ï¼‰ |
| `/api/gallery/featured` | GET | æ—  | ç²¾é€‰æŽ¨è |
| `/api/gallery/tags/popular` | GET | æ—  | çƒ­é—¨æ ‡ç­¾ |
| `/api/gallery/stats` | GET | æ—  | åˆ†ç±»ç»Ÿè®¡ |
| `/api/gallery/search` | GET | å¯é€‰ | å…¨æ–‡æœç´¢ |
| `/api/gallery/:id` | GET | å¯é€‰ | è¯¦æƒ…ï¼ˆè‡ªåŠ¨å¢žåŠ viewsï¼‰ + ç›¸å…³æŽ¨è |
| `/api/gallery/:id/copy` | POST | æ—  | è®°å½•å¤åˆ¶æ¬¡æ•° |
| `/api/gallery/:id/like` | POST | å¿…é¡» | ç‚¹èµž/å–æ¶ˆç‚¹èµž |
| `/api/gallery/:id/favorite` | POST | å¿…é¡» | æ”¶è—/å–æ¶ˆæ”¶è— |

**è®¾è®¡åŽŸåˆ™:**
- çº¯æµè§ˆä¸éœ€è¦ç™»å½• â†’ åˆ—è¡¨/è¯¦æƒ…/æœç´¢/å¤åˆ¶éƒ½å¯åŒ¿åä½¿ç”¨
- ç™»å½•åŽè§£é”æ”¶è—/ç‚¹èµžåŠŸèƒ½ â†’ ä½¿ç”¨ `optionalAuth` å’Œ `requireAuth` ä¸­é—´ä»¶åˆ†åˆ«å¤„ç†
- è¯¦æƒ…é¡µè‡ªåŠ¨è¿”å›žç›¸å…³æŽ¨èï¼ˆåŒæ¨¡åž‹+åŒåˆ†ç±» æˆ– å…±äº«æ ‡ç­¾çš„æç¤ºè¯ï¼‰

#### `server/routes/seedance.js` â€” Seedance API
åŒæ ·çš„æŽ¥å£è®¾è®¡ï¼Œé¢å¤–æä¾› `/api/seedance/categories` ç«¯ç‚¹è¿”å›žåˆ†ç±»ç»Ÿè®¡ã€‚

### 2.4 é“¾æŽ¥å¥åº·æ£€æŸ¥

#### `server/scripts/checkLinkHealth.js`

```bash
# ä»…æ£€æŸ¥ï¼ˆæŠ¥å‘Šå¤±æ•ˆé“¾æŽ¥ï¼‰
node server/scripts/checkLinkHealth.js

# è‡ªåŠ¨ä¿®å¤ï¼ˆæ ‡è®°è¿žç»­å¤±è´¥3æ¬¡çš„ä¸ºä¸æ´»è·ƒï¼‰
node server/scripts/checkLinkHealth.js --fix

# é™åˆ¶æ£€æŸ¥æ•°é‡
node server/scripts/checkLinkHealth.js --limit 50
```

**å·¥ä½œåŽŸç†:**
1. ä½¿ç”¨ HTTP HEAD è¯·æ±‚æ£€æµ‹ URL å¯è®¿é—®æ€§
2. æ­£å¸¸ â†’ é‡ç½® `failCount` ä¸º 0
3. å¤±è´¥ â†’ `failCount` + 1
4. è¿žç»­å¤±è´¥ â‰¥ 3 æ¬¡ â†’ ä½¿ç”¨ `--fix` å‚æ•°å¯è‡ªåŠ¨å°† `isActive` è®¾ä¸º false

### 2.5 è·¯ç”±æ³¨å†Œ

åœ¨ `server/index.js` ä¸­æ–°å¢ž:
```javascript
const galleryRoutes = require('./routes/gallery');
const seedanceRoutes = require('./routes/seedance');
// ...
app.use('/api/gallery', galleryRoutes);
app.use('/api/seedance', seedanceRoutes);
```

---

## ä¸‰ã€æ–‡ä»¶å˜æ›´æ¸…å•

| æ“ä½œ | æ–‡ä»¶ | è¯´æ˜Ž |
|------|------|------|
| NEW | `server/models/GalleryPrompt.js` | ç”»å»Šæç¤ºè¯æ•°æ®æ¨¡åž‹ï¼ˆ175è¡Œï¼‰ |
| NEW | `server/models/SeedancePrompt.js` | Seedanceè§†é¢‘æ•°æ®æ¨¡åž‹ï¼ˆ130è¡Œï¼‰ |
| NEW | `server/scripts/importNanoBanana.js` | NanoBananaæ•°æ®å¯¼å…¥è„šæœ¬ï¼ˆ230è¡Œï¼‰ |
| NEW | `server/scripts/importSeedance.js` | Seedanceæ•°æ®å¯¼å…¥è„šæœ¬ï¼ˆ200è¡Œï¼‰ |
| NEW | `server/routes/gallery.js` | ç”»å»ŠAPIè·¯ç”±ï¼ˆ280è¡Œï¼‰ |
| NEW | `server/routes/seedance.js` | SeedanceAPIè·¯ç”±ï¼ˆ240è¡Œï¼‰ |
| NEW | `server/scripts/checkLinkHealth.js` | é“¾æŽ¥å¥åº·æ£€æŸ¥è„šæœ¬ï¼ˆ130è¡Œï¼‰ |
| MODIFY | `server/index.js` | æ³¨å†Œæ–°è·¯ç”±ï¼ˆ+4è¡Œï¼‰ |
| NEW | `.gitignore` | Gitå¿½ç•¥è§„åˆ™ |
| NEW | `20260222_é¡¹ç›®é‡æž„è¯¦ç»†æ‰§è¡Œè®¡åˆ’.md` | è®¡åˆ’æ–‡æ¡£ |

---

## å››ã€ç”¨æˆ·ç¡®è®¤çš„å…³é”®å†³ç­–è®°å½•

| # | å†³ç­– | ç”¨æˆ·å›žå¤ |
|---|------|---------|
| 1 | å›¾ç‰‡/è§†é¢‘ä¿ç•™å¤–éƒ¨é“¾æŽ¥ | âœ… æŽ¥å—ï¼Œä½†è¦æœ‰å¤±æ•ˆæ£€æµ‹ â†’ å·²å®žçŽ° `checkLinkHealth.js` |
| 2 | è€æ¨¡åž‹ä¸åŠ¨ï¼Œæ–°å»ºç‹¬ç«‹æ¨¡åž‹ | âœ… æŽ¥å— |
| 3 | ç”»å»Šäº¤äº’æ–¹å¼ | çº¯æµè§ˆä¸éœ€ç™»å½•ï¼Œç™»å½•åŽå¯æ”¶è—/ç‚¹èµž â†’ å·²å®žçŽ° `optionalAuth` |
| 4 | å¯¼èˆªä¸‰æ¿å—å¹¶åˆ— | âœ… æŽ¥å—ï¼ˆmeigen.ai é£Žæ ¼ï¼‰ |
| 5 | ä½¿ç”¨ meigen.ai æ•°æ® | å¯ä»¥ç”¨æ•°æ®ä½†ä¸ç›´æŽ¥é“¾æŽ¥ç½‘ç«™ â†’ åŽç»­é˜¶æ®µå®žçŽ° |
| 6 | Google ç™»å½• | éœ€æ–°å¢ž â†’ åŽç»­é˜¶æ®µå®žçŽ° |

---

## äº”ã€ä¸‹ä¸€æ­¥

> **é˜¶æ®µ 2**: å‰ç«¯é¡µé¢é‡æž„
> - ä»¿ meigen.ai é£Žæ ¼çš„ç”»å»Šé¡µé¢
> - Seedance è§†é¢‘å±•ç¤ºé¡µé¢
> - å¯¼èˆªæ æ”¹ç‰ˆ
> - App.js è·¯ç”±æ›´æ–°
